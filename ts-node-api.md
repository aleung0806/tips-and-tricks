# Typescript Node REST API Boilerplate

This is a template for building a REST API using Node, Express and Mongodb.

### Features
**Type-based request validation** with [zod]() \
**Authentication** with [passport]() with ```passport-local```, ```passport-google-oauth20``` and ```passport-github2``` \
**Authorization**  with configurable role-based or action-based permissions \
**Session caching** with [redis]() \
**NoSQL database** with [mongodb]() and [mongoose]() \
**OpenAPI documentation** with [swagger-ui-express]() \
**Logging** with [winston]() and [morgan]() \
**Code quality** with [prettier]() and [eslint]() \
**Docker support**

### To start:

1. Install dependences ```npm install```. 
2. Copy ```example.env``` and change the desired variables.
3. Make sure ```mongo``` and ```redis``` are installed and running. 
4. If using Google Oauth 2.0 or Github Oauth, register your app with their API and update your ```.env```.
2. Run server with ```npm start```.

### Run in a Docker container
1. Build with ```docker build . -t <image-tag>```. 
2. Run with ```docker run -p <host-port>:3001 -d <image-tag>```. Choose whatever local port you'd like to map to for ```<host-port>```.

### To add a new resource

1. Write a zod schema for the resource. Infer the type from it. Zod allows run-time typechecking for, for example, request validation. Zod has useful typescript-like utilities like pick and omit.

2. Write your mongoose schema and type it with your type. Extend the mongoose types for statics and methods if need be.

3. Write your routes for your resource in the doc files.









API for User resource

Authentication: 
Authentication is handled by passport. Passport allows the use of multiple authentication strategies. passport-local, google-oauth20, and passport-github2 strategies are used. 

## API Documentation
Go to 'http://localhost:3000/v1/docs' to view the documentation page generated using [swagger]().

### Todo:
- Docker support
- testing with jest

### To investigate:
regex
mongoose guide - model vs doc vs collection etc
instance of, classes, prototype methods, etc
winston logging debug
postman for flows
swagger for autogenerated client
cypress for testing?








Verify Email Flow: Client: /register {email, password, username}

Server: redirect to verification page Check to see email is not taken Generate a token. Send an email with the link /verify-email

/verify-email On click, redirect to verification successful.
